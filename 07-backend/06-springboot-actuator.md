# Spring Boot Actuator

## Actuator?

Spring Boot Actuator는 운영 환경에서 애플리케이션을 모니터링하고 관리하기 위한 기능을 제공하는 라이브러리이다.

-   Production-ready 기능: 애플리케이션의 상태, 메트릭, 환경 정보 등을 HTTP 엔드포인트로 노출
-   Health Check: 애플리케이션과 의존성 서비스의 상태를 실시간으로 확인
-   메트릭 수집: CPU, 메모리, HTTP 요청 등 다양한 시스템 메트릭 제공
-   외부 모니터링 도구 연동: Prometheus, Grafana 등과의 쉬운 통합

## 어떤 로그를 붙일 수 있는지

### 주요 기본 엔드포인트

```bash
# 애플리케이션 상태 확인
GET /actuator/health

# 시스템 메트릭 조회
GET /actuator/metrics

# 애플리케이션 정보 조회
GET /actuator/info

# HTTP 요청 통계
GET /actuator/metrics/http.server.requests

# 데이터베이스 연결 상태
GET /actuator/health/db
```

### 1. Health Indicators

애플리케이션과 의존성 서비스의 상태를 모니터링

### 2. 커스텀 메트릭

비즈니스 로직과 관련된 메트릭을 수집

## 데이터 로그 제안

## 공연 (Performance)

| 로그 항목               | Admin | Developer | DevOps | Actuator 구현 가능성 |
| ----------------------- | ----- | --------- | ------ | -------------------- |
| **공연 정보 변경 사항** | 전체  | 전체      | 없음   | 불가능               |
| **공연별 예매 현황**    | 전체  | 통계만    | 통계만 | 부분가능             |

### 공연 카테고리 Actuator 구현 참고사항

-   **불가능 항목**: 비즈니스 로직 데이터로 별도 구현 필요
-   **부분가능 항목**: Custom Metrics로 통계 정보만 가능

---

## 예약 (Reservation)

| 로그 항목                                     | Admin  | Developer | DevOps | Actuator 구현 가능성 |
| --------------------------------------------- | ------ | --------- | ------ | -------------------- |
| **예매 프로세스의 각 단계별 성공/실패 추적**  | 전체   | 전체      | 통계만 | 부분가능             |
| **좌석 잠금/해제 이벤트 모니터링**            | 통계만 | 전체      | 통계만 | 부분가능             |
| **결제/환불 처리 과정 상세 기록**             | 전체   | 전체      | 없음   | 불가능               |
| **좌석 선택 충돌 에러 모니터링**              | 통계만 | 전체      | 전체   | 가능                 |
| **예매 프로세스에서 병목 구간 식별**          | 요약   | 전체      | 전체   | 가능                 |
| **비정상적인 예매 시도 탐지 (봇, 매크로 등)** | 전체   | 없음      | 통계만 | 부분가능             |

### 예약 카테고리 Actuator 구현 참고사항

-   **가능 항목**: `/metrics`, `/httptrace` 활용
-   **부분가능 항목**: Custom Metrics + Counter로 통계만 제공
-   **불가능 항목**: 상세 비즈니스 데이터로 별도 API 필요

---

## 유저 (User)

| 로그 항목                         | Admin | Developer | DevOps | Actuator 구현 가능성 |
| --------------------------------- | ----- | --------- | ------ | -------------------- |
| **유저 정보 변경 사항**           | 전체  | 전체      | 없음   | 불가능               |
| **로그인/로그아웃 기록**          | 전체  | 통계만    | 통계만 | 부분가능             |
| **반복적인 로그인 실패 모니터링** | 전체  | 없음      | 통계만 | 부분가능             |
| **관리자 권한 사용 내역 추적**    | 전체  | 없음      | 없음   | 불가능               |

### 유저 카테고리 Actuator 구현 참고사항

-   **부분가능 항목**: Custom Metrics로 카운트 정보만 제공
-   **불가능 항목**: 보안/개인정보로 별도 보안 로깅 시스템 필요

---

## 트래픽 컨트롤 (Traffic Control)

| 로그 항목                                     | Admin | Developer | DevOps | Actuator 구현 가능성 |
| --------------------------------------------- | ----- | --------- | ------ | -------------------- |
| **좌석 조회 API 호출 빈도 분석**              | 요약  | 전체      | 전체   | 가능                 |
| **대량 예매 발생 시 서버 부하 모니터링**      | 요약  | 통계만    | 전체   | 가능                 |
| **시스템 부하로 인한 타임아웃 추적**          | 요약  | 전체      | 전체   | 가능                 |
| **자동 스케일링 결정을 위한 임계치 설정**     | 요약  | 없음      | 전체   | 가능                 |
| **관리자 대시보드에 실시간 시스템 상태 표시** | 전체  | 요약      | 전체   | 가능                 |

### 트래픽 컨트롤 Actuator 구현 참고사항

-   **가능 항목**: `/health`, `/metrics`, `/httptrace`, `/threaddump` 활용
-   Actuator가 가장 적합한 카테고리

---

## 배포 (Deployment)

| 로그 항목                          | Admin | Developer | DevOps | Actuator 구현 가능성 |
| ---------------------------------- | ----- | --------- | ------ | -------------------- |
| **애플리케이션 빌드 로그**         | 없음  | 전체      | 전체   | 불가능               |
| **배포 프로세스 실행 로그**        | 요약  | 전체      | 전체   | 불가능               |
| **배포 성공/실패 현황**            | 전체  | 전체      | 전체   | 부분가능             |
| **롤백 실행 기록**                 | 전체  | 전체      | 전체   | 불가능               |
| **CI/CD 파이프라인 실행 로그**     | 없음  | 전체      | 전체   | 불가능               |
| **테스트 결과 로그**               | 요약  | 전체      | 전체   | 불가능               |
| **배포 환경별 설정 변경 이력**     | 요약  | 전체      | 전체   | 부분가능             |
| **컨테이너 이미지 빌드/배포 로그** | 없음  | 통계만    | 전체   | 불가능               |
| **배포 승인/반려 이력**            | 전체  | 통계만    | 전체   | 불가능               |

### 배포 카테고리 Actuator 구현 참고사항

-   **부분가능 항목**: `/info`, `/env` 엔드포인트로 기본 정보만 제공
-   **불가능 항목**: 외부 CI/CD 시스템과 연동 필요

## References

-   https://toss.tech/article/how-to-work-health-check-in-spring-boot-actuator
-   https://docs.spring.io/spring-boot/docs/3.0.5/reference/html/actuator.html
